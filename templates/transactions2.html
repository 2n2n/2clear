<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2clear</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <link rel="stylesheet" href="/static/bower_components/bootstrap/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/bower_components/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/static/bower_components/Ionicons/css/ionicons.min.css">
  <link rel="stylesheet" href="/static/css/AdminLTE.min.css">
  <link rel="stylesheet" href="/static/css/skins/_all-skins.min.css">
  <link rel="stylesheet" href="/static/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css">
  <script type="text/javascript" src="/static/plugins/jQuery/jQuery.min.js"></script>
  <script type="text/javascript" src="/static/addoption.js"></script>
</head>

<body class="hold-transition skin-blue sidebar-mini">



  <div class="wrapper">

    <header class="main-header">
      <a class="logo">
        <span class="logo-mini">
          <b>A</b>LT</span>
        <span class="logo-lg">
          <b>2</b>Clear</span>
      </a>
      <nav class="navbar navbar-static-top">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
        <!-- Navbar Right Menu -->
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <!-- Messages: style can be found in dropdown.less-->

            <!-- Tasks: style can be found in dropdown.less -->
            <li class="dropdown tasks-menu">
              <a href="/logout" class="dropdown-toggle" data-toggle="dropdown">
                <i class=" fa-sign-out"></i>
                <span class="label label-danger">Log-out</span>
              </a>

            </li>
          </ul>
        </div>
      </nav>
    </header>
    <aside class="main-sidebar">
      <section class="sidebar">
        <div class="user-panel">
          <div class="pull-left image">
            <img src="/static/img/user2-160x160.jpg" class="img-circle" alt="User Image">
          </div>
          <div class="pull-left info">
            <p id="user">{{session.name}}</p>
            <a href="#">
              <i class="fa fa-circle text-success"></i> Online</a>
          </div>
        </div>
        <form action="#" method="get" class="sidebar-form">
          <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Search...">
            <span class="input-group-btn">
              <button type="submit" name="search" id="search-btn" class="btn btn-flat">
                <i class="fa fa-search"></i>
              </button>
            </span>
          </div>
        </form>
      </section>
    </aside>

    <div class="content-wrapper">

      <section class="content">
        <h1> Transactions & Orders
          <small>2clear</small>
        </h1>
        <div class="row">
          <div class="col-lg-3 col-xs-6">
            <div class="small-box bg-aqua">
              <div class="inner">
                <h3 id="transactioncount">00</h3>

                <p>Transactions</p>
              </div>
              <div class="icon">
                <i class="ion ion-bag"></i>
              </div>
              <a href="/transactions" class="small-box-footer">Go
                <i class="fa fa-arrow-circle-right"></i>
              </a>
            </div>
          </div>
          <div class="col-lg-3 col-xs-6">
            <div class="small-box bg-yellow">
              <div class="inner">
                <h3 id="userregistration">00</h3>

                <p>Customer Registrations</p>
              </div>
              <div class="icon">
                <i class="ion ion-person-add"></i>
              </div>
              <a href="/registrations" class="small-box-footer">Go
                <i class="fa fa-arrow-circle-right"></i>
              </a>
            </div>
          </div>
          <div class="col-lg-3 col-xs-6">
            <div class="small-box bg-green">
              <div class="inner">
                <h3>2
                  <sup style="font-size: 20px">clear</sup>
                </h3>

                <p>Inventory</p>
              </div>
              <div class="icon">
                <i class="ion ion-stats-bars"></i>
              </div>
              <a href="/products" class="small-box-footer">Go
                <i class="fa fa-arrow-circle-right"></i>
              </a>
            </div>
          </div>
          <div class="col-lg-3 col-xs-6">
            <div class="small-box bg-red">
              <div class="inner">
                <h3>65</h3>

                <p>Admin Panel</p>
              </div>
              <div class="icon">
                <i class="ion ion-pie-graph"></i>
              </div>
              <a href="/admin" class="small-box-footer">Go
                <i class="fa fa-arrow-circle-right"></i>
              </a>
            </div>
          </div>
        </div>

        <div class="row">
          <section class="col-lg-7 connectedSortable">
            <div class="nav-tabs-custom">
              <div class="box box-primary">
                <div class="box box-primary">
                  <div class="box-header with-border">
                    <h3 class="box-title">Order</h3>
                  </div>
                  <form role="form" action="/order" method="post">
                    <div class="box-body">
                      <div class="form-group">



                        <label for="user_name">Name:</label>
                        <!-- <input list="customers" name= "customers" id="selectcustomer" class="form-control"> -->
                        <select id="customers" class="form-control">
                          {% for customers in customers %}
                          <option value="{{ customers.id }}">{{ customers.name }}</option>
                          {% endfor %}
                        </select>
                      </div>
                      <div class="form-group">
                        <label for="customeradress">Customer address:</label>
                        <input v-model="message" id="customeraddress" class="form-control" placeholder="ex: san pendro st 123">
                      </div>

                      <div class="form-group">
                        <label for="customernumber">Customer number:</label>
                        <input v-model="message" id="customernumber" class="form-control" placeholder="ex: 09123456789">
                      </div>
                      <div class="form-group">
                        <label for="order">Products:</label>

                        <table class="table table-bordered">
                          <thead>
                            <tr>
                              <th>ID</th>
                              <th>name</th>
                              <th>type</th>
                              <th>Price</th>

                              <th>Amount</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for row in products %}
                            <tr>

                              <td>{{ row.id }}</td>
                              <td>{{ row.pname }}</td>
                              <td>{{ row.ptype }}</td>
                              <td>{{ row.pprice }}</td>

                              <td>

                                <div class="center">
                                  <p>
                                  </p>
                                  <div class="input-group">
                                    <span class="input-group-btn">
                                      <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field={{ row.id }}>
                                        <span class="glyphicon glyphicon-minus"></span>
                                      </button>
                                    </span>
                                    <input type="text" name={{ row.id }} class="form-control input-number" value="0" min="0" max="100">
                                    <span class="input-group-btn">
                                      <button type="button" class="btn btn-default btn-number" data-type="plus" data-field={{ row.id }}>
                                        <span class="glyphicon glyphicon-plus"></span>
                                      </button>
                                    </span>
                                  </div>
                                  <p></p>

                                  <div class="form-check">
                                    <label>
                                      <input type="checkbox" name="check" +{{ row.id }}>
                                      <span class="label-text">RENT</span>
                                    </label>


                              </td>
                              <!-- <td><a href="/update/{row.id}" class="btn btn-primary">Update</a> <a href="/delete/{row.id}">Delete</a></td> -->
                              {% else %}
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>

                        <label for="customernumber">Total Bill:</label>
                        <input v-model="message" id="TotalBill" class="form-control" readonly="true">

                  </form>
                  </div>
                  </div>
          </section>
          </div>
        </body>
</html>

<script type="text/javascript">
  $(function () {
    $('#customers').on('change', function () {
      var id = $(this).find(":selected").val();
      console.log(id, 'id');
      var jqaxhr = $.ajax({
        method: "GET",
        url: window.location.origin + "/customer/" + id
      })
        .done(function (data) {
          console.log(data);
          $('#customeraddress').val(data.address);
          $('#customernumber').val(data.number);

        })
        .fail(function (e) {
          alert('error')
        })
        .always(function () {
        })
    });
  })

  $(function () {
    $('#selectproduct').on('change', function () {
      var id = $(this).find(":selected").val();
      console.log(id, 'id');
      var jqaxhr = $.ajax({
        method: "GET",
        url: window.location.origin + "/price/" + id
      })
        .done(function (data) {
          console.log(data);
          $('#price').val(data.pprice);

        })
        .fail(function (e) {
          alert('error')
        })
        .always(function () {
        })
    });
  })


  //plugin bootstrap minus and plus
  //http://jsfiddle.net/laelitenetwork/puJ6G/
  $('.btn-number').click(function (e) {
    e.preventDefault();

    fieldName = $(this).attr('data-field');
    type = $(this).attr('data-type');
    var input = $("input[name='" + fieldName + "']");
    var currentVal = parseInt(input.val());
    if (!isNaN(currentVal)) {
      if (type == 'minus') {

        if (currentVal > input.attr('min')) {
          input.val(currentVal - 1).change();
        }
        if (parseInt(input.val()) == input.attr('min')) {
          $(this).attr('disabled', true);
        }

      } else if (type == 'plus') {

        if (currentVal < input.attr('max')) {
          input.val(currentVal + 1).change();
        }
        if (parseInt(input.val()) == input.attr('max')) {
          $(this).attr('disabled', true);
        }

      }
    } else {
      input.val(0);
    }
  });
  $('.input-number').focusin(function () {
    $(this).data('oldValue', $(this).val());
  });
  $('.input-number').change(function () {

    minValue = parseInt($(this).attr('min'));
    maxValue = parseInt($(this).attr('max'));
    valueCurrent = parseInt($(this).val());

    name = $(this).attr('name');
    if (valueCurrent >= minValue) {
      $("[data-type='minus'][data-field='" + name + "']").removeAttr('disabled')
    } else {
      alert('Sorry, the minimum value was reached');
      $(this).val($(this).data('oldValue'));
    }
    if (valueCurrent <= maxValue) {
      $(".btn-number[data-type='plus'][data-field='" + name + "']").removeAttr('disabled')
    } else {
      alert('Sorry, the maximum value was reached');
      $(this).val($(this).data('oldValue'));
    }


  });
  $(".input-number").keydown(function (e) {
    // Allow: backspace, delete, tab, escape, enter and .
    if ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 190]) !== -1 ||
      // Allow: Ctrl+A
      (e.keyCode == 65 && e.ctrlKey === true) ||
      // Allow: home, end, left, right
      (e.keyCode >= 35 && e.keyCode <= 39)) {
      // let it happen, don't do anything
      return;
    }
    // Ensure that it is a number and stop the keypress
    if ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {
      e.preventDefault();
    }
  });



</script>